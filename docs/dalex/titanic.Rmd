---
title: "Boilerplate Notebook"
author: ""
date: "12 June 2018"
output: 
  html_notebook: 
    df_print: kable
    code_folding: hide
    highlight: tango
    theme: journal
    toc: yes
---

```{r setup, include=FALSE}
#######################
# Global Code Options #
#######################
knitr::opts_chunk$set(echo = TRUE, results = 'hide', tidy = TRUE,
                      cache = FALSE, prompt = FALSE,
                      comment = NA, message = FALSE, warning = FALSE)
#'
########################################
# Load Project Libraries and Functions #
########################################
k_path_project <<- rprojroot::find_rstudio_root_file()
source(file.path(k_path_project, "code", "scripts", "setup.R"))
```

```{r get_titanic_data}
titanic_raw <- get_titanic_raw_data()
```

```{r tidy_the_data}
titanic_tidy <- 
    titanic_raw %>%
    # Convert the target variable to factor 
    mutate(Survived = factor(Survived, levels = 0:1, labels = c("No","Yes"))) %>%
    # Convert character variables to factor
    mutate_if(is.character, as.factor) %>%
    # Select variables
    select(Set, Survived, Sex)

assert_all_are_not_na(titanic_tidy %>% select(-Survived))
```

```{r split_the_data}
train_tidy <- titanic_tidy %>% dplyr::filter(Set %in% "train") %>% select(-Set)
test_tidy <- titanic_tidy %>%  dplyr::filter(Set %in% "test") %>% select(-Set)
```


```{r fit_linear_model}
mdl_logreg <- glm(Survived ~ . + 0, family = binomial, data = train_tidy)
mdl_logreg %>% summary()
```





```{r, out.width = "100%", dpi = 200, fig.height = 8}

```